/*! cacheJS 21-06-2016 */
!function(e,t){"use strict";var r=function(){var e="localStorage";return{init:function(e){this.localStorageProvider=new a(e),this.arrayProvider=new o(e)},use:function(t){e=t},getProvider:function(t){switch(t||e){case"localStorage":return this.localStorageProvider;case"array":return this.arrayProvider}}}},n=function(){var e={prefix:"_cache",ttl:604800},t={cacheAdded:[],cacheRemoved:[]},n={generateKey:function(t){var r=e.prefix+"_",n=[];for(var a in t)t.hasOwnProperty(a)&&n.push(a);n.sort();for(var o=0;o<n.length;o++)r+=n[o]+"_"+t[n[o]],o!==n.length-1&&(r+="__");return r},generateContextKey:function(t,r){return e.prefix+"_context_"+t+"_"+r},getCurrentTime:function(){var e=(new Date).getTime();return Math.floor(e/1e3)},getDefault:function(){return e},getEventSubscribers:function(){return t},dispatchEvent:function(e,r){var a=t[e];if(!(a.length<1))for(var o=0;o<a.length;o++)void 0!==a[o]&&n.isFunction(a[o])&&a[o](r)},isFunction:function(e){return"[object Function]"==Object.prototype.toString.call(e)}},a=new r;return a.init(n),{use:function(e){return a.use(e),this},get:function(e){return a.getProvider().get(e)},set:function(e,t,r,n){try{a.getProvider().set(e,t,r,n)}catch(e){return null}return this},setPrefix:function(t){return e.prefix=t,this},getPrefix:function(){return e.prefix},removeByKey:function(e){return a.getProvider().removeByKey(e),this},removeByContext:function(e){return a.getProvider().removeByContext(e),this},on:function(e,r){t[e].push(r)},unsubscribe:function(e,r){for(var n=t[e],a=0;a<n.length;a++)if(n[a]===r){delete n[a];break}}}},a=function(e){return{get:function(t){var r=e.generateKey(t),n=localStorage.getItem(r);return null!==n?(n=JSON.parse(n),e.getCurrentTime()-n.createdAt>=n.ttl?(localStorage.removeItem(r),null):n.data):null},set:function(t,r,n,a){n=n||e.getDefault().ttl;var o=e.generateKey(t);for(var i in localStorage.setItem(o,JSON.stringify({data:r,ttl:n,createdAt:e.getCurrentTime()})),a)if(a.hasOwnProperty(i)){var l=e.generateContextKey(i,a[i]),u=localStorage.getItem(l);if(null!==u){u=JSON.parse(u);var c=!1;if(Array.prototype.indexOf)c=u.indexOf(o)>=0;else for(var f=0;f<u.length;f++)if(u[f]==o){c=!0;break}c||u.push(o)}else u=[o];localStorage.setItem(l,JSON.stringify(u))}e.dispatchEvent("cacheAdded",{key:t,value:r,ttl:n,contexts:a||null})},removeByKey:function(t){var r=e.generateKey(t),n=localStorage.getItem(r);null!==n&&(n=JSON.parse(n),localStorage.removeItem(r),e.dispatchEvent("cacheRemoved",{generatedKey:r,value:n.data,ttl:n.ttl}))},removeByContext:function(t){for(var r in t)if(t.hasOwnProperty(r)){var n=e.generateContextKey(r,t[r]),a=localStorage.getItem(n);if(null===a)return;for(var o=JSON.parse(a),i=0;i<o.length;i++){var l=JSON.parse(localStorage.getItem(o[i]));localStorage.removeItem(o[i]),e.dispatchEvent("cacheRemoved",{generatedKey:o[i],value:l.data,ttl:l.ttl})}localStorage.removeItem(n)}}}},o=function(e){var t={},r={};return{get:function(r){var n=e.generateKey(r);if(t.hasOwnProperty(n)){var a=t[n];return e.getCurrentTime()-a.createdAt>=a.ttl?(delete t[n],null):a.data}return null},set:function(n,a,o,i){var l=e.generateKey(n);for(var u in o=null==o?e.getDefault().ttl:o,t[l]={data:a,ttl:o,createdAt:e.getCurrentTime()},i)if(i.hasOwnProperty(u)){var c=e.generateContextKey(u,i[u]),f=r.hasOwnProperty(c)?r[c]:null;if(null!==f){var v=!1;if(Array.prototype.indexOf)v=f.indexOf(l)>=0;else for(var g=0;g<f.length;g++)if(f[g]==l){v=!0;break}v||f.push(l)}else f=[l];r[c]=f}e.dispatchEvent("cacheAdded",{key:n,value:a,ttl:o,contexts:i||null})},removeByKey:function(r){var n=e.generateKey(r);if(t.hasOwnProperty(n)){var a=t[n];delete t[n],e.dispatchEvent("cacheRemoved",{generatedKey:n,value:a.data,ttl:a.ttl})}},removeByContext:function(n){for(var a in n)if(n.hasOwnProperty(a)){var o=e.generateContextKey(a,n[a]),i=r.hasOwnProperty(o)?r[o]:null;if(null===i)return;for(var l=0;l<i.length;l++){var u=t[i[l]];delete t[i[l]],e.dispatchEvent("cacheRemoved",{generatedKey:i[l],value:u.data,ttl:u.ttl})}delete r[o]}}}};n.VERSION="1.1.2",e.cacheJS=new n}(this);